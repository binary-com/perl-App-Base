jobs:
  test:
    parameters:
      perl-version:
        description: The Perl version we want to test with
        type: string
        default: "5.32"
    docker:
      - image: perldocker/perl-tester:<< parameters.perl-version >>
    steps:
      - checkout
      - run:
          name: Install dependencies
          command: |
            cpm install -g \
            --cpanfile cpanfile \
            --with-develop \
            --with-suggests \
            --show-build-log-on-failure
      - run:
          name: Run Tests
          command: |
            prove -lr --jobs 2 t xt

workflows:
  build-workflow:
    jobs: &1
    - test:
        matrix:
          parameters:
            perl-version:
              - "5.10"
              - "5.12"
              - "5.14"
              - "5.16"
              - "5.18"
              - "5.20"
              - "5.22"
              - "5.24"
              - "5.26"
              - "5.28"
              - "5.30"
version: 2.1
